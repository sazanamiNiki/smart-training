## 課題：暗号化されたクレジットカード番号の検証 💳

### 概要
この課題では、XOR暗号で暗号化されたクレジットカード番号を復号し、その番号がLuhnアルゴリズムのルールに則って有効かどうか、さらにどのカードブランドに属するかを判定する、一連の処理を実装します。

---
### 必要な知識

#### XOR暗号
XOR（排他的論理和）はビット演算の一つで、**暗号化と復号に全く同じ操作を使える**という特徴があります。ある数字Aを鍵BでXORした結果に、もう一度同じ鍵BをXORすると、元の数字Aに戻ります。
`(A XOR B) XOR B = A`

#### Luhnアルゴリズム
カード番号が偶然の打ち間違いでないかを検証するための簡単なチェックサム計算式です。以下の手順で計算します。
1.  カード番号の**右端から2番目**の桁を開始点とし、1つおきに数字を**2倍**します。
2.  2倍にした結果が2桁（10以上）になった場合、その2つの数字を**足し合わせて**1桁の数字にします。（例: `7 * 2 = 14` → `1 + 4 = 5`）
3.  処理されなかった桁も含め、すべての数字を**合計**します。
4.  この合計が**10で割り切れれば**、番号は有効です。

---
### あなたのミッション
提供される`main`関数の中で、あなたが実装する`encrypt`関数と`decryptAndValidate`関数を呼び出し、最終的な検証結果を返すようにしてください。実装のメインは、以下の2つの関数です。

1.  **`encrypt(cardNumber, key)`**: カード番号をXOR暗号化する。
2.  **`decryptAndValidate(encryptedData, key)`**: 暗号化されたデータを復号し、検証する。

---
### 詳細な仕様

#### `encrypt`関数
* **入力**:
    * `cardNumber: string`: カード番号文字列（ハイフンやスペースを含む場合がある）。
    * `key: number`: 暗号化に使う`0`〜`255`の範囲の数値。
* **処理**:
    1.  `cardNumber`から、数字以外の文字をすべて取り除きます。
    2.  残った数字の文字列を、1文字ずつ数値に変換します。
    3.  各数値を`key`とXOR演算します。
* **出力**: `number[]`: 暗号化された数値の配列。

#### `decryptAndValidate`関数
* **入力**:
    * `encryptedData: number[]`: `encrypt`関数で生成された、暗号化済みの数値配列。
    * `key: number`: 暗号化に使われたものと同じ`key`。
* **処理**:
    1.  `encryptedData`の各数値を、`key`を使って**XOR復号**します。
    2.  復号した数字を文字列に結合し、元のカード番号（数字のみ）に戻します。
    3.  カード番号が2桁未満の場合や、Luhnアルゴリズムとして無効な場合は、`'無効なカード番号'`を返します。
    4.  Luhnアルゴリズムが有効な場合、以下の**カードブランドのルール**に合致するか判定します。
* **出力**: `string`: 最終的な判定結果。

---
### カードブランドのルール
* **Visa**: `4`で始まり、桁数が**16桁**。
* **Mastercard**: `51`〜`55`のいずれかで始まり、桁数が**16桁**。
* **American Express**: `34`または`37`で始まり、桁数が**15桁**。

---
### 入出力の全体像
`main`関数は、`encrypt`と`decryptAndValidate`を内部で呼び出します。

* **`main`関数の入力**: `cardNumber: string`, `key: number`
* **`main`関数の出力**: `string`
    * 判定結果: `'Visa'`, `'Mastercard'`, `'American Express'`, `'有効なカード番号'`, `'無効なカード番号'`

### 実装例
```javascript
// main関数は内部で暗号化→復号→検証の全てを行います
```
// main関数は内部で暗号化→復号→検証の全てを行います
main('4242-4242-4242-4243', 55)    // Luhnチェックで失敗 -> '無効なカード番号'

main('5123 4567 8901 2346', 101)   // Luhnチェック成功, Mastercardのルールに合致 -> 'Mastercard'
main('4242 4242 4242 4242', 123)  // Luhnチェック成功, Visaのルールに合致 -> 'Visa'
main('3779-863184-30142', 200)   // Luhnチェック成功, Amexのルールに合致 -> 'American Express'

main('79927398713', 10)    // Luhnチェック成功, ブランドルールに合致しない -> '有効なカード番号'

```
